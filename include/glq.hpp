/**********************************************************************************************************************************
                                            Monomial's Library by Tiago Fernandes Moherdaui

            The library is meant to make operations with monomials easier by use of indicial notation.

            This file provides Gauss-Legendre quadrature pairs (position, weight) for order up to 61.

                    Pairs for position in [-1,1] and weights in [0,2]           mnl::GaussLegendre(k);
                    Pairs for position in [0,1] and weights in [0,1]            mnl::GaussLegendreR(k);

            This is produced in C++11 and includes only <array> and <vector>.

**********************************************************************************************************************************/

#ifndef GLQ
#define GLQ
#include "mnl.hpp"
#include <vector>

namespace mnl {
    // Compressed look-up table
    constexpr std::array<double, 480> _clut{
    0.57735026918963,	1.,
    0.77459666924148,	0.555555555555556,
    0.33998104358486,	0.652145154862546,
    0.86113631159405,	0.347854845137454,
    0.5384693101057,		0.478628670499366,
    0.9061798459387,		0.236926885056189,
    0.2386191860832,		0.467913934572691,
    0.6612093864663,		0.360761573048139,
    0.9324695142032,		0.17132449237917,
    0.4058451513774,		0.381830050505119,
    0.7415311855994,		0.279705391489277,
    0.9491079123428,		0.12948496616887,
    0.1834346424956,		0.362683783378362,
    0.5255324099163,		0.313706645877887,
    0.7966664774136,		0.222381034453374,
    0.9602898564975,		0.101228536290376,
    0.3242534234038,		0.312347077040003,
    0.6133714327006,		0.260610696402935,
    0.8360311073266,		0.180648160694857,
    0.9681602395076,		0.0812743883615744,
    0.1488743389816,		0.295524224714753,
    0.4333953941292,		0.269266719309996,
    0.679409568299,		0.219086362515982,
    0.865063366689,		0.149451349150581,
    0.9739065285172,		0.0666713443086881,
    0.2695431559523,		0.262804544510247,
    0.5190961292068,		0.23319376459199,
    0.730152005574,		0.186290210927734,
    0.8870625997681,		0.125580369464905,
    0.9782286581461,		0.0556685671161737,
    0.1252334085115,		0.249147045813403,
    0.3678314989982,		0.233492536538355,
    0.5873179542866,		0.203167426723066,
    0.7699026741943,		0.160078328543346,
    0.9041172563705,		0.106939325995318,
    0.9815606342467,		0.0471753363865118,
    0.2304583159551,		0.226283180262897,
    0.4484927510364,		0.207816047536889,
    0.6423493394403,		0.178145980761946,
    0.8015780907333,		0.138873510219787,
    0.917598399223,		0.0921214998377284,
    0.9841830547186,		0.0404840047653159,
    0.1080549487073,		0.215263853463158,
    0.3191123689279,		0.205198463721296,
    0.5152486363582,		0.185538397477938,
    0.6872929048117,		0.157203167158194,
    0.8272013150698,		0.121518570687903,
    0.9284348836636,		0.08015808715976,
    0.986283808697,		0.0351194603317519,
    0.2011940939974,		0.198431485327112,
    0.3941513470776,		0.186161000015562,
    0.5709721726085,		0.166269205816994,
    0.72441773136,		0.139570677926154,
    0.84820658341,		0.1071592204671719,
    0.937273392401,		0.0703660474881081,
    0.98799251802,		0.0307532419961173,
    0.0950125098376,		0.189450610455068,
    0.2816035507793,		0.182603415044924,
    0.458016777657,		0.169156519395003,
    0.617876244403,		0.149595988816577,
    0.755404408355,		0.124628971255534,
    0.865631202388,		0.095158511682493,
    0.944575023073,		0.0622535239386479,
    0.989400934992,		0.0271524594117541,
    0.1784841814958,		0.176562705366993,
    0.351231763454,		0.16800410215645,
    0.512690537086,		0.15404576107681,
    0.657671159217,		0.135136368468525,
    0.781514003897,		0.111883847193404,
    0.880239153727,		0.0850361483171792,
    0.950675521769,		0.0554595293739872,
    0.990575475314,		0.0241483028685479,
    0.084775013042,		0.169142382963144,
    0.251886225692,		0.164276483745833,
    0.411751161463,		0.154684675126265,
    0.559770831074,		0.140642914670651,
    0.69168704306,		0.122555206711478,
    0.803704958973,		0.100942044106287,
    0.892602466498,		0.076425730254889,
    0.955823949571,		0.0497145488949698,
    0.991565168421,		0.0216160135264833,
    0.16035864564,		0.158968843393954,
    0.316564099964,		0.15276604206586,
    0.464570741376,		0.142606702173607,
    0.600545304662,		0.128753962539336,
    0.720966177335,		0.111566645547334,
    0.822714656537,		0.09149002162245,
    0.903155903615,		0.0690445427376412,
    0.960208152135,		0.0448142267656996,
    0.992406843844,		0.0194617882297265,
    0.076526521133,		0.152753387130726,
    0.227785851142,		0.149172986472604,
    0.373706088715,		0.142096109318382,
    0.510867001951,		0.131688638449177,
    0.636053680727,		0.118194531961518,
    0.74633190646,		0.10193011981724,
    0.839116971822,		0.083276741576705,
    0.912234428251,		0.0626720483341091,
    0.963971927278,		0.0406014298003869,
    0.993128599185,		0.0176140071391521,
    0.145561854161,		0.14452440398997,
    0.288021316802,		0.139887394791073,
    0.424342120207,		0.132268938633337,
    0.551618835887,		0.121831416053729,
    0.667138804197,		0.1087972991671484,
    0.768439963476,		0.0934444234560339,
    0.853363364583,		0.0761001136283793,
    0.92009933415,		0.0571344254268572,
    0.967226838566,		0.0369537897708525,
    0.99375217062,		0.0160172282577743,
    0.06973927332,		0.139251872855632,
    0.207860426688,		0.136541498346015,
    0.341935820892,		0.131173504787062,
    0.469355837987,		0.123252376810512,
    0.587640403507,		0.112932296080539,
    0.694487263187,		0.100414144442881,
    0.787816805979,		0.085941606217068,
    0.86581257772,		0.06979646842452,
    0.926956772187,		0.0522933351526833,
    0.970060497835,		0.0337749015848142,
    0.994294585482,		0.0146279952982722,
    0.133256824298,		0.132462039404697,
    0.26413568097,		0.128905722188082,
    0.39030103803,		0.12304908430673,
    0.509501477846,		0.114996640222411,
    0.619609875764,		0.1048920914645414,
    0.718661363132,		0.0929157660600351,
    0.804888401619,		0.079281411776719,
    0.87675235827,		0.0642324214085259,
    0.932971086826,		0.0480376717310847,
    0.972542471218,		0.0309880058569794,
    0.994769334998,		0.0134118594871418,
    0.064056892863,		0.127938195346752,
    0.191118867474,		0.125837456346828,
    0.315042679696,		0.121670472927803,
    0.433793507626,		0.115505668053726,
    0.545421471389,		0.107444270115966,
    0.648093651937,		0.097618652104114,
    0.740124191579,		0.086190161531953,
    0.820001985974,		0.07334648141108,
    0.886415527004,		0.0592985849154368,
    0.938274552003,		0.0442774388174198,
    0.974728555971,		0.0285313886289337,
    0.995187219997,		0.0123412297999872,
    0.122864692611,		0.12224244299031,
    0.243866883721,		0.119455763535785,
    0.361172305809,		0.114858259145712,
    0.473002731446,		0.1085196244742637,
    0.577662930241,		0.1005359490670506,
    0.673566368473,		0.0910282619829636,
    0.759259263037,		0.080140700335001,
    0.833442628761,		0.0680383338123569,
    0.894991997878,		0.0549046959758352,
    0.942974571229,		0.0409391567013063,
    0.97666392146,		0.0263549866150321,
    0.99555696979,		0.01139379850102629,
    0.059230093429,		0.118321415279262,
    0.176858820357,		0.116660443485297,
    0.292004839486,		0.11336181654632,
    0.403051755123,		0.108471840528577,
    0.508440714825,		0.102059161094425,
    0.606692293018,		0.094213800355914,
    0.69642726042,		0.085045894313485,
    0.776385948821,		0.07468414976566,
    0.845445942788,		0.0632740463295748,
    0.902637861984,		0.0509758252971478,
    0.947159066662,		0.0379623832943628,
    0.978385445956,		0.0244178510926319,
    0.995885701146,		0.010551372617343,
    0.11397258561,		0.1134763461089651,
    0.22645936544,		0.1112524883568452,
    0.335993903639,		0.1075782857885332,
    0.44114825175,		0.1025016378177458,
    0.540551564579,		0.0960887273700285,
    0.632907971946,		0.088423158543757,
    0.717013473739,		0.0796048677730578,
    0.791771639071,		0.0697488237662456,
    0.856207908018,		0.0589835368598336,
    0.909482320677,		0.0474494125206151,
    0.950900557815,		0.0352970537574197,
    0.979923475962,		0.0226862315961806,
    0.996179262889,		0.00979899605129436,
    0.055079289884,		0.110047013016475,
    0.164569282133,		0.108711192258294,
    0.272061627635,		0.106055765922846,
    0.376251516089,		0.102112967578061,
    0.475874224955,		0.09693065799793,
    0.569720471811,		0.090571744393033,
    0.656651094039,		0.083113417228901,
    0.735610878014,		0.074646214234569,
    0.805641370917,		0.065272923967,
    0.865892522574,		0.0551073456757167,
    0.915633026392,		0.0442729347590042,
    0.954259280629,		0.0329014277823044,
    0.981303165371,		0.0211321125927713,
    0.996442497574,		0.0091242825930945,
    0.106278230133,		0.1058761550973209,
    0.211352286166,		0.1040733100777294,
    0.314031637868,		0.101091273759915,
    0.413152888174,		0.0969638340944086,
    0.507592955124,		0.0917377571392588,
    0.596281797138,		0.0854722573661725,
    0.678214537603,		0.0782383271357638,
    0.752462851734,		0.0701179332550513,
    0.818185487615,		0.0612030906570791,
    0.87463780492,		0.0515948269024979,
    0.921180232953,		0.0414020625186828,
    0.957285595778,		0.0307404922020936,
    0.982545505261,		0.0197320850561227,
    0.996679442261,		0.00851690387874641,
    0.051471842555,		0.102852652893559,
    0.153869913609,		0.101762389748406,
    0.254636926168,		0.099593420586795,
    0.352704725531,		0.096368737174644,
    0.447033769538,		0.092122522237786,
    0.536624148142,		0.086899787201083,
    0.620526182989,		0.08075589522942,
    0.697850494793,		0.073755974737705,
    0.767777432105,		0.06597422988218,
    0.829565762383,		0.0574931562176191,
    0.882560535792,		0.0484026728305941,
    0.926200047429,		0.038799192569627,
    0.960021864968,		0.0287847078833234,
    0.98366812328,		0.018466468311091,
    0.996893484075,		0.0079681924961666,
    0.099555312152,		0.0992250112266723,
    0.198121199336,		0.0977433353863287,
    0.294718069982,		0.0952902429123195,
    0.388385901608,		0.0918901138936415,
    0.478193782045,		0.0875767406084779,
    0.563249161407,		0.0823929917615893,
    0.642706722924,		0.0763903865987766,
    0.715776784587,		0.0696285832354104,
    0.781733148417,		0.0621747865610284,
    0.839920320146,		0.0541030824249169,
    0.889760029948,		0.0454937075272011,
    0.930756997897,		0.0364322739123855,
    0.962503925093,		0.0270090191849794,
    0.984685909665,		0.0173186207903106,
    0.997087481819,		0.00747083157924878
    };

    const std::vector<std::array<double, 2>> GaussLegendre(const monOrder k) {
        const int n = (int)ceil((k + 1.) / 2.);
        const size_t startIndex = (size_t)floor((n - 1) * (n - 1) / 4.);
        const size_t readLength = (size_t)floor(n / 2.);

        std::vector<std::array<double, 2>> out;
        double wSum = 0.0;
        for (size_t i{}; i < readLength; ++i) {
            const double xi = _clut[2 * (startIndex + i)], wi = _clut[2 * (startIndex + i) + 1];
            out.push_back({ xi, wi });
            out.push_back({ -xi, wi });
            wSum += wi;
        }

        if (!(n % 2))
            return out;


        out.push_back({ 0, 2. * (1. - wSum) });
        return out;
    }

    const std::vector<std::array<double, 2>> GaussLegendreR(const monOrder k) {
        const int n = (int)ceil((k + 1.) / 2.);
        const size_t startIndex = (size_t)floor((n - 1) * (n - 1) / 4.);
        const size_t readLength = (size_t)floor(n / 2.);

        std::vector<std::array<double, 2>> out;
        double wSum = 0.0;
        for (size_t i{}; i < readLength; ++i) {
            const double xi = 0.5 * _clut[2 * (startIndex + i)] + .5, wi = _clut[2 * (startIndex + i) + 1] * .5;
            out.push_back({ xi, wi });
            out.push_back({ 1. - xi , wi });
            wSum += 2 * wi;
        }

        if (!(n % 2))
            return out;


        out.push_back({ .5, 1. - wSum });
        return out;
    }
}
#endif